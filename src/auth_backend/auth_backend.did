t  service auth {
    generate_token : (principal: principal) -> (text);
    validate_token : (text) -> (Claims) query;
    get_user_roles : (principal) -> (vec UserRole) query;
}

type Claims = record {
    sub: principal;
    exp: nat64;
    roles: vec UserRole;
};

type User = record {
    principal: principal;
    roles: vec UserRole;
    session_token: text;
    expires_at: nat64;
};

type UserRole = variant { Admin; DeviceManager; Viewer };